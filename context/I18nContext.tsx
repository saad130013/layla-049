import React, { createContext, useState, ReactNode, useEffect, useCallback } from 'react';
import { Translations } from '../types';

interface I18nContextType {
  language: 'en' | 'ar';
  dir: 'ltr' | 'rtl';
  setLanguage: (lang: 'en' | 'ar') => void;
  t: (key: string) => string;
  formatDate: (date: string | Date | number, options?: Intl.DateTimeFormatOptions) => string;
  formatNumber: (value: number, options?: Intl.NumberFormatOptions) => string;
  formatCurrency: (value: number) => string;
}

export const I18nContext = createContext<I18nContextType>({} as I18nContextType);

const translations: Translations = {
  en: {
    // ... existing keys ...
    login: 'Login',
    loginError: 'Invalid credentials',
    username: 'Username',
    password: 'Password',
    dashboard: 'Dashboard',
    newInspection: 'New Inspection',
    reportingHub: 'Reporting Hub',
    settings: 'Settings',
    logout: 'Logout',
    welcome: 'Welcome',
    darkMode: 'Dark Mode',
    lightMode: 'Light Mode',
    notifications: 'Notifications',
    noNewNotifications: 'No new notifications',
    viewAll: 'View All',
    inspectors: 'Inspectors',
    standards: 'Standards',
    alerts: 'Alerts',
    cdr: 'CDR',
    cdrList: 'CDR List',
    myReports: 'My Performance',
    myPerformanceAnalysis: 'My Performance Analysis',
    inspectorAverages: 'Inspector Averages',
    inspectorAveragesAnalysis: 'Inspector Averages Analysis',
    heatmap: 'Heatmap',
    penaltyInvoices: 'Penalty Invoices',
    globalPenaltyStatements: 'Global Penalty Statements',
    contractDetails: 'Contract Details',
    criticalIssues: 'Critical Issues',
    inspectorFeedback: 'Inspector Feedback',
    myInspectionsList: 'My Inspections',
    pendingReviews: 'Pending Reviews',
    returnedReports: 'Returned Reports',
    completedReports: 'Completed Reports',
    resubmitReport: 'Resubmit Report',
    returnToInspector: 'Return to Inspector',
    approveReport: 'Approve Report',
    managerNotesPlaceholder: 'Enter notes for the inspector...',
    smartScheduler: 'Smart Scheduler',
    taskTracker: 'Task Tracker',
    scheduleGenerator: 'Schedule Generator',
    globalSearchPlaceholder: 'Search...',
    highRisk: 'High Risk',
    mediumRisk: 'Medium Risk',
    lowRisk: 'Low Risk',
    today: 'Today',
    last7Days: 'Last 7 Days',
    lastMonth: 'Last Month',
    last3Months: 'Last 3 Months',
    allTime: 'All Time',
    totalReports: 'Total Reports',
    totalViolations: 'Total Violations',
    visitedZones: 'Visited Zones',
    averageScore: 'Average Score',
    myAssignedTasks: 'My Assigned Tasks',
    pendingTasks: 'Pending Tasks',
    startInspection: 'Start Inspection',
    performanceTrend: 'Performance Trend',
    riskCategoryDistribution: 'Risk Category Distribution',
    reportHistory: 'Report History',
    latestFeedback: 'Latest Feedback',
    noFeedback: 'No feedback available',
    date: 'Date',
    zone: 'Zone',
    zoneType: 'Zone Type',
    score: 'Score',
    view: 'View',
    downloadMonthlyReport: 'Download Monthly Report',
    systemHealthy: 'System Healthy',
    noCriticalIssues: 'No critical issues detected.',
    overallCompliance: 'Overall Compliance',
    totalInspections: 'Total Inspections',
    pendingCDRs: 'Pending CDRs',
    topInspector: 'Top Inspector',
    aiInsights: 'AI Insights',
    inspectorActivityOverview: 'Inspector Activity Overview',
    liveActivityFeed: 'Live Activity Feed',
    lowPerformingAreas: 'Low Performing Areas',
    needsAttention: 'Needs Attention',
    inspector: 'Inspector',
    location: 'Location',
    subLocations: 'Sub-locations',
    startEvaluation: 'Start Evaluation',
    selectRiskCategory: 'Select Risk Category',
    subLocationPlaceholder: 'Add sub-location...',
    reportDetails: 'Report Details',
    downloadPdf: 'Download PDF',
    saveAsDraft: 'Save as Draft',
    submitReport: 'Submit Report',
    addFeedback: 'Add Feedback',
    submitFeedback: 'Submit Feedback',
    supervisorFeedback: 'Supervisor Feedback/Notes',
    maxScore: 'Max Score',
    possibleNotes: 'Possible Notes',
    additionalNotes: 'Additional Notes',
    addANote: 'Add a note...',
    photoEvidence: 'Photo Evidence',
    uploadPhoto: 'Upload Photo',
    noPhotosUploaded: 'No photos uploaded.',
    referenceNumber: 'Reference Number',
    status: 'Status',
    exportToPdf: 'Export to PDF',
    exportToExcel: 'Export to Excel',
    exportToCsv: 'Export to CSV',
    filter: 'Filter',
    cdrId: 'CDR ID',
    managerDecision: 'Manager Decision',
    userManagement: 'User Management',
    addUser: 'Add User',
    supervisors: 'Supervisors',
    fullName: 'Full Name',
    role: 'Role',
    actions: 'Actions',
    editUser: 'Edit User',
    email: 'Email',
    cancel: 'Cancel',
    save: 'Save',
    myProfile: 'My Profile',
    changePassword: 'Change Password',
    currentPassword: 'Current Password',
    newPassword: 'New Password',
    confirmNewPassword: 'Confirm New Password',
    passwordMismatch: 'Passwords do not match',
    passwordUpdated: 'Password updated successfully',
    incorrectPassword: 'Incorrect current password',
    newCDR: 'New CDR',
    dateOfIncident: 'Date of Incident',
    timeOfIncident: 'Time of Incident',
    wardLocation: 'Ward / Location',
    typeOfIncident: 'Type of Incident',
    inCharge: 'In Charge',
    name: 'Name',
    idNo: 'ID No',
    serviceType: 'Service Type',
    manpowerDiscrepancy: 'Manpower Discrepancy',
    materialDiscrepancy: 'Material Discrepancy',
    equipmentDiscrepancy: 'Equipment Discrepancy',
    onSpotAction: 'On Spot Action',
    actionPlan: 'Action Plan',
    staffComment: 'Staff Comment',
    attachments: 'Attachments',
    submitToManager: 'Submit to Manager',
    managerReview: 'Manager Review',
    managerComment: 'Manager Comment',
    approveAndFinalize: 'Approve & Finalize',
    markAllAsRead: 'Mark all as read',
    generateReports: 'Generate Reports',
    summaryReports: 'Summary Reports',
    weeklySummaryReport: 'Weekly Summary Report',
    monthlyKpiReport: 'Monthly KPI Report',
    inspectorPerformanceReport: 'Inspector Performance Report',
    selectInspector: 'Select Inspector',
    dateFrom: 'Date From',
    dateTo: 'Date To',
    generateReport: 'Generate Report',
    performanceAnalysis: 'Performance Analysis',
    analyzeAverages: 'Analyze Averages',
    weekly: 'Weekly',
    monthly: 'Monthly',
    hospitalHeatmap: 'Hospital Heatmap',
    locationPerformanceHeatmap: 'Location Performance Heatmap',
    avgComplianceScore: 'Avg Compliance Score',
    legend: 'Legend',
    noData: 'No Data',
    pendingApproval: 'Pending Approval',
    deducted: 'Deducted',
    invoiceId: 'Invoice ID',
    generatedDate: 'Generated Date',
    totalAmount: 'Total Amount',
    clearFilters: 'Clear Filters',
    noInvoices: 'No invoices found.',
    penaltyInvoice: 'Penalty Invoice',
    invoiceDetails: 'Invoice Details',
    violationItem: 'Violation Item',
    category: 'Category',
    amount: 'Amount',
    approveDeduction: 'Approve Deduction',
    officialPenaltyReport: 'Official Penalty Report',
    introStatement: 'This document serves as an official notification of penalty deduction based on the discrepancies noted.',
    totalsSection: 'Totals Section',
    totalPenaltyViolations: 'Total Penalty Violations',
    totalPenaltyAmountDue: 'Total Penalty Amount Due',
    signatures: 'Signatures',
    facilityManager: 'Facility Manager',
    globalPenaltyStatementsList: 'Global Penalty Statements',
    createStatement: 'Create Statement',
    month: 'Month',
    year: 'Year',
    generateStatement: 'Generate Statement',
    statementPeriod: 'Statement Period',
    noStatementsFound: 'No statements found.',
    globalPenaltyStatement: 'Global Penalty Statement',
    occurrenceCount: 'Occurrence Count',
    penaltyPerOccurrence: 'Penalty Per Occurrence',
    total: 'Total',
    managerNotes: 'Manager Notes',
    approve: 'Approve',
    reject: 'Reject',
    deleteRow: 'Delete Row',
    generalComments: 'General Comments',
    refreshData: 'Refresh Data',
    approveStatement: 'Approve Statement',
    penaltyStatementTitle: 'Monthly Penalty Statement',
    statementIntro: 'This statement summarizes all penalties for the month.',
    evsSupervisor: 'EVS Supervisor',
    contractorRepresentative: 'Contractor Representative',
    addManualPenalty: 'Add Manual Penalty',
    manualEntry: 'Manual Entry',
    autoImportCdr: 'Auto Import CDR',
    selectViolation: 'Select Violation',
    quantity: 'Quantity',
    selectCdrToImport: 'Select CDR to Import',
    linkCdrs: 'Link CDRs',
    noCdrsFound: 'No CDRs found.',
    calculatedPenalty: 'Calculated Penalty',
    noFinancialPenaltiesInCDR: 'No financial penalties in this CDR.',
    addPenalty: 'Add Penalty',
    maintenanceCleaningContract: 'Maintenance & Cleaning Contract',
    days: 'Days',
    zoneLevel: 'Zone Level',
    areas: 'Areas',
    costPerDay: 'Cost Per Day',
    vatPerDay: 'VAT Per Day',
    dailyTotal: 'Daily Total',
    monthlyValue: 'Monthly Value',
    monthlyVat: 'Monthly VAT',
    monthlyTotal: 'Monthly Total',
    cleaningSuppliesList: 'Cleaning Supplies List',
    equipmentDevicesList: 'Equipment & Devices List',
    no: 'No.',
    itemName: 'Item Name',
    unit: 'Unit',
    criticalIssuesList: 'Critical Issues List',
    requiresImmediateAction: 'issues require immediate action',
    filterByMonth: 'Filter by Month',
    searchByNameOrLocation: 'Search by Name or Location',
    failedItems: 'Failed Items',
    warnInspector: 'Warn Inspector',
    supervisorFeedbackList: 'Supervisor Feedback List',
    filterByLocation: 'Filter by Location',
    feedbackComment: 'Feedback Comment',
    noFeedbackFound: 'No feedback found.',
    complianceScoreByArea: 'Compliance Score by Area',
    bestPerforming: 'Best Performing',
    worstPerforming: 'Worst Performing',
    openCDRs: 'Open CDRs',
    avgProcessingTime: 'Avg Processing Time',
    rejectedReports: 'Rejected Reports',
    none: 'None',
    predictiveRiskHotspots: 'Predictive Risk Hotspots',
    proactiveActionRecommended: 'Proactive action recommended',
    riskIndex: 'Risk Index',
    keyFactors: 'Key Factors',
    lowLastScore: 'Low Last Score',
    overdueInspection: 'Overdue Inspection',
    recentCDRs: 'Recent CDRs',
    zoneDetails: 'Zone Details',
    backToDashboard: 'Back to Dashboard',
    inspectorPerformanceAnalytics: 'Inspector Performance Analytics',
    completedTasksHistory: 'Completed Tasks History',
    viewReport: 'View Report',
    Pending: 'Pending',
    Completed: 'Completed',
    dueDate: 'Due Date',
    priority: 'Priority',
    reason: 'Reason',
    High: 'High',
    Normal: 'Normal',
    Low: 'Low',
    generateSmartSchedule: 'Generate Smart Schedule',
    publishTasks: 'Publish Tasks',
    proposedSchedule: 'Proposed Schedule',
    clearList: 'Clear List',
    notVisited: 'Not Visited (30+ days)',
    routineCheck: 'Routine Check',
    lowScore: 'Low Score in Last Visit',
    executiveDashboard: 'Executive Dashboard',
    lastWeek: 'Last Week',
    lastQuarter: 'Last Quarter',
    last6Months: 'Last 6 Months',
    lastYear: 'Last Year',
    overallAvgCompliance: 'Overall Avg Compliance',
    systemWideItemPerformance: 'System-wide Item Performance',
    sortByCompliance: 'Sort by Compliance',
    evaluationItem: 'Evaluation Item',
    timesInspected: 'Times Inspected',
    avgCompliance: 'Avg Compliance',
    itemPerformanceAnalysis: 'Item Performance Analysis',
    overallPerformance: 'Overall Performance',
    filterByPeriod: 'Filter by Period',
    topDepartments: 'Top Departments',
    totalCDRs: 'Total CDRs',
    commonDiscrepancies: 'Common Discrepancies',
    generatedReportNotice: 'This is a system generated report.',
    confidential: 'Confidential',
    inspectionForm: 'Inspection Form',
    inspectionReportTitle: 'Inspection Report',
    myPerformanceReportTitle: 'My Performance Report',
    period: 'Period',
    confirmDelete: 'Are you sure you want to delete this user?',
    userDeleted: 'User deleted successfully.',
    userUpdated: 'User updated successfully.',
    userCreated: 'User created successfully.',
    confirmRefresh: 'Are you sure you want to refresh the data? All unsaved changes will be lost.',
    confirmApprove: 'Are you sure you want to approve this statement?',
    statementApprovedSuccess: 'Statement approved successfully.',
    statementExistsError: 'A statement already exists for this month and year.',
    pleaseSelectManagerDecision: 'Please select a manager decision before approving.',
    inspectorPerformance: 'Inspector Performance',
    viewReportLink: 'View Report',
    manual: 'Manual',
    auto: 'Auto',
    pleaseSelect: '-- Select --',
    printReport: 'Print Report',
    defects: 'Defects',
    comments: 'Comments',
    avgOverallScore: 'Avg Overall Score',
    avgScoreHighRisk: 'Avg Score High Risk',
    avgScoreMediumRisk: 'Avg Score Medium Risk',
    avgScoreLowRisk: 'Avg Score Low Risk',
    Draft: 'Draft',
    Submitted: 'Submitted (Pending Review)',
    Reviewed: 'Reviewed',
    Returned: 'Returned',
    Approved: 'Approved (Completed)',
    NeedsAction: 'Needs Action',
    locations: 'Locations',
    employeeSignature: 'Employee Signature',
    managerSignature: 'Manager Signature',
    discrepancyCategories: 'Discrepancy Categories',
    basicIncidentInformation: 'Basic Incident Information',
    publishSelectedTasks: 'Publish Selected Tasks',
    selected: 'Selected',
    confirmSubmitReport: 'Are you sure you want to submit this report? This action cannot be undone.',
    reportSubmittedSuccess: 'Report submitted successfully!',
    
    // NEW CONTRACTOR KEYS
    contractorDashboard: 'Contractor Dashboard',
    rectificationRequired: 'Rectification Required',
    rectificationCompleted: 'Rectification Completed',
    requestRectification: 'Request Rectification from Contractor',
    submitRectification: 'Submit Rectification',
    actionsTaken: 'Actions Taken by Contractor',
    proofPhotos: 'Proof Photos',
    rectificationRequests: 'Rectification Requests',
    noRectificationRequests: 'No reports requiring rectification at the moment.',
    fixNow: 'Fix Now',
    acceptRectification: 'Accept Fix & Close',
    rejectRectification: 'Reject & Return to Contractor',
    
    // Statuses
    RectificationRequired: 'Rectification Required',
    RectificationCompleted: 'Rectification Completed',

    // HIGH RISK ITEMS
    hr_item_1: 'Floors - Cleanliness & Condition',
    hr_item_2: 'Walls - Cleanliness & Paint Condition',
    hr_item_3: 'Medical Equipment - Dust Free & Clean',
    hr_item_4: 'Waste Bins - Emptied & Clean',
    hr_item_5: 'Windows - Cleanliness inside/out',
    hr_item_6: 'Ceilings - No Stains or Damage',
    hr_item_7: 'Lighting - Functional & Clean',
    hr_item_8: 'Doors - Cleanliness & Handles',
    hr_item_9: 'Curtains/Blinds - Cleanliness',
    hr_item_10: 'Bedding - Clean & Changed',
    hr_item_11: 'Bathroom - Cleanliness & Sanitization',
    hr_item_12: 'Soap Dispensers - Full & Working',
    hr_item_13: 'Paper Towels - Available',
    hr_item_14: 'Odor - Neutral/Pleasant',
    hr_item_15: 'Safety Signs - Posted & Visible',

    // MEDIUM RISK ITEMS
    mr_item_1: 'Floors - Cleanliness',
    mr_item_2: 'Walls - Cleanliness',
    mr_item_3: 'Furniture - Dust Free',
    mr_item_4: 'Waste Bins - Emptied',
    mr_item_5: 'Windows - Cleanliness',
    mr_item_6: 'Ceilings - No Stains',
    mr_item_7: 'Lighting - Functional',
    mr_item_8: 'Doors - Cleanliness',
    mr_item_9: 'Carpets - Vacuumed',
    mr_item_10: 'Reception Area - Tidy',
    mr_item_11: 'Bathroom - Cleanliness',
    mr_item_12: 'Soap Dispensers - Full',
    mr_item_13: 'Paper Towels - Available',
    mr_item_14: 'Odor - Neutral',
    mr_item_15: 'Safety Signs - Posted',
    mr_item_16: 'Walkways - Clear of Obstruction',

    // LOW RISK ITEMS
    lr_item_1: 'Floors - Cleanliness',
    lr_item_2: 'Walls - Cleanliness',
    lr_item_3: 'Furniture - Dust Free',
    lr_item_4: 'Waste Bins - Emptied',
    lr_item_5: 'Windows - Cleanliness',
    lr_item_6: 'Ceilings - No Stains',
    lr_item_7: 'Lighting - Functional',
    lr_item_8: 'Doors - Cleanliness',
    lr_item_9: 'Carpets - Vacuumed',
    lr_item_10: 'Gardens - Well Maintained',
    lr_item_11: 'Bathroom - Cleanliness',
    lr_item_12: 'Soap Dispensers - Full',
    lr_item_13: 'Paper Towels - Available',
    lr_item_14: 'Odor - Neutral',
    lr_item_15: 'Parking - Clean & Tidy',
    
    // --- Penalty Translations ---
    penalty_a1: 'Failure to clean equipment daily or repair cleaning equipment properly and not following safety procedures.',
    penalty_a2: 'Delay in submitting required correspondence, reports, and documents.',
    penalty_a3: 'Failure to prepare and submit monthly employee task/area schedules on time.',
    penalty_a4: 'Failure of contractor’s staff to comply with uniform, shoes, or displaying ID badges.',
    penalty_a5: 'Failure to maintain personal hygiene (body, nails, hair, uniform).',
    penalty_a6: 'Failure to provide clearance certificate for departing employees.',
    penalty_a7: 'Failure to follow proper cleaning procedures for public areas as per policies.',
    penalty_a8: 'Failure to collect non-medical waste on time or follow instructions for transport.',
    penalty_a9: 'Delay in equipment maintenance causing work interruption.',
    penalty_b1: 'Failure to supply daily consumables/tools for each site.',
    penalty_b2: 'Failure to follow administrative directions (delivery delays, policy non-compliance, etc.).',
    penalty_b3: 'Employee absence or late arrival without approval – per hour.',
    penalty_b4: 'Failure to prepare/submit required professional training program.',
    penalty_b5: 'Failure to place warning signs during cleaning in medical areas.',
    penalty_b6: 'Failure to respond promptly to cleaning-related complaints.',
    penalty_b7: 'Employee taking leave without prior approval.',
    penalty_b8: 'Failure to collect non-medical waste from wings/medical areas.',
    penalty_c1: 'Failure to meet management & supervision competence standards.',
    penalty_c2: 'Improper handling of non-medical waste, exposing people/environment to harm.',
    penalty_c3: 'Improper handling of medical waste, exposing people/environment to harm.',
    penalty_c4: 'Failure to collect medical waste on time or follow transport procedures.',
    penalty_c5: 'Failure to respond to emergencies (floods, fire, evacuation).',
    penalty_c6: 'Use of unlicensed cleaning materials inside the facility.',
    penalty_c7: 'Providing misleading information on manpower attendance or reports.',
    penalty_c8: 'Hiring workers without approval.',
    penalty_c9: 'Failure to pay workers’ salaries.',
    penalty_d1: 'Failure to follow directives for cleaning patient rooms, ORs, and healthcare areas.',
    penalty_d2: 'Failure to wear proper PPE in required areas.',
    penalty_d3: 'Failure to inform project representative before employee exit or replacement.',
    penalty_d4: 'Failure to fill any contract-defined position – per week per position.',
    penalty_d5: 'Failure to fill vacant positions – per week per worker.',
    penalty_d6: 'Negligence causing injuries or property damage – contractor bears costs.',
    penalty_d7: 'Failure to follow infection control policies and safety procedures.',
    penalty_d8: 'Improper use of chemicals exposing staff/patients/visitors to harm.',
    penalty_d9: 'Issuing cleaning supplies or tools for non-work purposes.',
  },
  ar: {
    // ... existing keys ...
    login: 'تسجيل الدخول',
    loginError: 'خطأ في تسجيل الدخول',
    username: 'اسم المستخدم',
    password: 'كلمة المرور',
    dashboard: 'لوحة القيادة',
    newInspection: 'تفتيش جديد',
    reportingHub: 'مركز التقارير',
    settings: 'الإعدادات',
    logout: 'خروج',
    welcome: 'مرحبا',
    taskTracker: 'تتبع المهام',
    smartScheduler: 'المجدول الذكي',
    scheduleGenerator: 'منشئ الجدول',
    pendingTasks: 'المهام المعلقة',
    completedTasksHistory: 'سجل المهام المنجزة',
    viewReport: 'عرض التقرير',
    Completed: 'مكتملة',
    Pending: 'قيد الانتظار',
    location: 'الموقع',
    inspector: 'المفتش',
    dueDate: 'تاريخ الاستحقاق',
    priority: 'الأولوية',
    reason: 'السبب',
    status: 'الحالة',
    High: 'عالي',
    Normal: 'عادي',
    Low: 'منخفض',
    noNewNotifications: 'لا توجد إشعارات جديدة',
    generateSmartSchedule: 'توليد الجدول الذكي',
    publishTasks: 'نشر المهام',
    proposedSchedule: 'الجدول المقترح',
    clearList: 'مسح القائمة',
    notVisited: 'لم تتم الزيارة (30+ يوم)',
    routineCheck: 'فحص روتيني',
    lowScore: 'درجة منخفضة في الزيارة السابقة',
    viewReportLink: 'عرض التقرير',
    inspectorPerformanceReport: 'تقرير أداء المفتش',
    downloadMonthlyReport: 'تحميل التقرير الشهري',
    criticalIssues: 'مشاكل حرجة',
    actions: 'إجراءات',
    save: 'حفظ',
    deleteRow: 'حذف الصف',
    addManualPenalty: 'إضافة مخالفة يدوية',
    cancel: 'إلغاء',
    total: 'المجموع',
    totalAmount: 'المبلغ الإجمالي',
    penaltyInvoice: 'فاتورة مخالفة',
    globalPenaltyStatement: 'بيان العقوبات الشامل',
    month: 'الشهر',
    year: 'السنة',
    publishSelectedTasks: 'نشر المهام المحددة',
    selected: 'محدد',
    pendingReviews: 'المراجعات المعلقة',
    returnedReports: 'التقارير المسترجعة',
    completedReports: 'التقارير المكتملة',
    resubmitReport: 'إعادة إرسال التقرير',
    returnToInspector: 'إرجاع إلى المفتش',
    approveReport: 'الموافقة على التقرير',
    managerNotesPlaceholder: 'أدخل ملاحظات للمفتش...',
    confirmSubmitReport: 'هل أنت متأكد من رغبتك في إرسال هذا التقرير؟ لا يمكن التراجع عن هذا الإجراء.',
    reportSubmittedSuccess: 'تم إرسال التقرير بنجاح!',
    Draft: 'مسودة',
    Submitted: 'تم الإرسال (قيد المراجعة)',
    Returned: 'مسترجع (للتعديل)',
    Approved: 'معتمد (مكتمل)',
    manualEntry: 'إدخال يدوي',
    autoImportCdr: 'استيراد تلقائي من CDR',
    selectCdrToImport: 'اختر CDR للاستيراد',
    linkCdrs: 'ربط CDRs',
    noCdrsFound: 'لا توجد سجلات',
    calculatedPenalty: 'الغرامة المحسوبة',
    noFinancialPenaltiesInCDR: 'لا توجد غرامات مالية في هذا السجل.',
    addPenalty: 'إضافة مخالفة',
    managerNotes: 'ملاحظات المدير',
    occurrenceCount: 'عدد التكرار',
    penaltyPerOccurrence: 'الغرامة لكل تكرار',
    violationItem: 'عنصر المخالفة',
    category: 'الفئة',
    signatures: 'التوقيعات',
    evsSupervisor: 'مشرف النظافة',
    facilityManager: 'مدير المنشأة',
    contractorRepresentative: 'ممثل المقاول',
    officialPenaltyReport: 'تقرير المخالفات الرسمي',
    introStatement: 'تعتبر هذه الوثيقة إشعاراً رسمياً بخصم الغرامة بناءً على التناقضات الملاحظة.',
    totalsSection: 'قسم الإجماليات',
    totalPenaltyViolations: 'إجمالي المخالفات',
    totalPenaltyAmountDue: 'إجمالي المبلغ المستحق',
    viewAll: 'عرض الكل',
    myInspectionsList: 'قائمة تفتيشاتي',
    date: 'التاريخ',
    noReportsFound: 'لا توجد تقارير',
    supervisorFeedback: 'ملاحظات المشرف',
    score: 'الدرجة',
    view: 'عرض',
    searchByNameOrLocation: 'البحث بالاسم أو الموقع',
    referenceNumber: 'الرقم المرجعي',
    filter: 'تصفية',
    clearFilters: 'مسح التصفية',
    deducted: 'مخصوم',
    pendingApproval: 'بانتظار الموافقة',
    invoiceId: 'رقم الفاتورة',
    generatedDate: 'تاريخ الإنشاء',
    approveDeduction: 'اعتماد الخصم',
    invoiceDetails: 'تفاصيل الفاتورة',
    approvedBy: 'تم الاعتماد من قبل',
    approvalDate: 'تاريخ الاعتماد',
    globalPenaltyStatementsList: 'قائمة العقوبات الشاملة',
    createStatement: 'إنشاء بيان',
    generateStatement: 'توليد البيان',
    statementPeriod: 'فترة البيان',
    totalViolations: 'إجمالي المخالفات',
    penaltyStatementTitle: 'بيان العقوبات الشهري',
    statementIntro: 'يلخص هذا البيان جميع العقوبات لهذا الشهر.',
    generalComments: 'تعليقات عامة',
    refreshData: 'تحديث البيانات',
    approveStatement: 'اعتماد البيان',
    approve: 'موافقة',
    reject: 'رفض',
    confirmRefresh: 'هل أنت متأكد من تحديث البيانات؟ ستفقد التغييرات غير المحفوظة.',
    confirmApprove: 'هل أنت متأكد من اعتماد هذا البيان؟',
    statementApprovedSuccess: 'تم اعتماد البيان بنجاح.',
    statementExistsError: 'يوجد بيان بالفعل لهذا الشهر والسنة.',
    amount: 'المبلغ',
    quantity: 'الكمية',
    selectViolation: 'اختر المخالفة',

    // NEW CONTRACTOR KEYS
    contractorDashboard: 'لوحة قيادة الشركة',
    rectificationRequired: 'مطلوب تصحيح',
    rectificationCompleted: 'تم التصحيح',
    requestRectification: 'طلب تصحيح من الشركة',
    submitRectification: 'إرسال التصحيح',
    actionsTaken: 'الإجراءات المتخذة من الشركة',
    proofPhotos: 'صور الإثبات',
    rectificationRequests: 'طلبات التصحيح',
    noRectificationRequests: 'لا توجد تقارير تتطلب تصحيح حالياً.',
    fixNow: 'بدء التصحيح',
    acceptRectification: 'قبول التصحيح وإغلاق',
    rejectRectification: 'رفض وإعادة للشركة',

    // Statuses
    RectificationRequired: 'مطلوب تصحيح',
    RectificationCompleted: 'تم التصحيح (بانتظار المفتش)',

    // HIGH RISK ITEMS - ARABIC
    hr_item_1: 'الأرضيات - النظافة والحالة',
    hr_item_2: 'الجدران - النظافة وحالة الطلاء',
    hr_item_3: 'المعدات الطبية - خالية من الغبار ونظيفة',
    hr_item_4: 'سلات المهملات - مفرغة ونظيفة',
    hr_item_5: 'النوافذ - النظافة من الداخل والخارج',
    hr_item_6: 'الأسقف - لا بقع أو تلف',
    hr_item_7: 'الإضاءة - تعمل ونظيفة',
    hr_item_8: 'الأبواب - النظافة والمقابض',
    hr_item_9: 'الستائر - النظافة',
    hr_item_10: 'الفراش - نظيف وتم تغييره',
    hr_item_11: 'الحمام - النظافة والتعقيم',
    hr_item_12: 'موزعات الصابون - ممتلئة وتعمل',
    hr_item_13: 'المناشف الورقية - متوفرة',
    hr_item_14: 'الرائحة - محايدة/مقبولة',
    hr_item_15: 'علامات السلامة - منشورة وواضحة',

    // MEDIUM RISK ITEMS - ARABIC
    mr_item_1: 'الأرضيات - النظافة',
    mr_item_2: 'الجدران - النظافة',
    mr_item_3: 'الأثاث - خالي من الغبار',
    mr_item_4: 'سلات المهملات - مفرغة',
    mr_item_5: 'النوافذ - النظافة',
    mr_item_6: 'الأسقف - لا بقع',
    mr_item_7: 'الإضاءة - تعمل',
    mr_item_8: 'الأبواب - النظافة',
    mr_item_9: 'السجاد - مكنوس',
    mr_item_10: 'منطقة الاستقبال - مرتبة',
    mr_item_11: 'الحمام - النظافة',
    mr_item_12: 'موزعات الصابون - ممتلئة',
    mr_item_13: 'المناشف الورقية - متوفرة',
    mr_item_14: 'الرائحة - محايدة',
    mr_item_15: 'علامات السلامة - منشورة',
    mr_item_16: 'الممرات - خالية من العوائق',

    // LOW RISK ITEMS - ARABIC
    lr_item_1: 'الأرضيات - النظافة',
    lr_item_2: 'الجدران - النظافة',
    lr_item_3: 'الأثاث - خالي من الغبار',
    lr_item_4: 'سلات المهملات - مفرغة',
    lr_item_5: 'النوافذ - النظافة',
    lr_item_6: 'الأسقف - لا بقع',
    lr_item_7: 'الإضاءة - تعمل',
    lr_item_8: 'الأبواب - النظافة',
    lr_item_9: 'السجاد - مكنوس',
    lr_item_10: 'الحدائق - صيانة جيدة',
    lr_item_11: 'الحمام - النظافة',
    lr_item_12: 'موزعات الصابون - ممتلئة',
    lr_item_13: 'المناشف الورقية - متوفرة',
    lr_item_14: 'الرائحة - محايدة',
    lr_item_15: 'مواقف السيارات - نظيفة ومرتبة',

    // PENALTY TRANSLATIONS - ARABIC
    penalty_a1: 'عدم تنظيف المعدات يوميًا أو إصلاح معدات التنظيف بشكل صحيح وعدم اتباع إجراءات السلامة.',
    penalty_a2: 'التأخير في تقديم المراسلات والتقارير والمستندات المطلوبة.',
    penalty_a3: 'عدم إعداد وتقديم جداول مهام/مناطق الموظفين الشهرية في الوقت المحدد.',
    penalty_a4: 'عدم التزام موظفي المقاول بالزي الرسمي أو الأحذية أو عرض شارات الهوية.',
    penalty_a5: 'عدم الحفاظ على النظافة الشخصية (الجسم، الأظافر، الشعر، الزي الرسمي).',
    penalty_a6: 'عدم تقديم شهادة خلو طرف للموظفين المغادرين.',
    penalty_a7: 'عدم اتباع إجراءات التنظيف الصحيحة للأماكن العامة حسب السياسات.',
    penalty_a8: 'عدم جمع النفايات غير الطبية في الوقت المحدد أو اتباع تعليمات النقل.',
    penalty_a9: 'التأخير في صيانة المعدات مما يتسبب في انقطاع العمل.',
    penalty_b1: 'عدم توفير المستهلكات/الأدوات اليومية لكل موقع.',
    penalty_b2: 'عدم اتباع التوجيهات الإدارية (تأخير التسليم، عدم الامتثال للسياسة، إلخ).',
    penalty_b3: 'غياب الموظف أو التأخر عن العمل بدون موافقة - في الساعة.',
    penalty_b4: 'عدم إعداد/تقديم برنامج التدريب المهني المطلوب.',
    penalty_b5: 'عدم وضع علامات تحذيرية أثناء التنظيف في المناطق الطبية.',
    penalty_b6: 'عدم الاستجابة الفورية للشكاوى المتعلقة بالنظافة.',
    penalty_b7: 'قيام الموظف بأخذ إجازة دون موافقة مسبقة.',
    penalty_b8: 'عدم جمع النفايات غير الطبية من الأجنحة/المناطق الطبية.',
    penalty_c1: 'عدم استيفاء معايير كفاءة الإدارة والإشراف.',
    penalty_c2: 'التعامل غير السليم مع النفايات غير الطبية، مما يعرض الناس/البيئة للضرر.',
    penalty_c3: 'التعامل غير السليم مع النفايات الطبية، مما يعرض الناس/البيئة للضرر.',
    penalty_c4: 'عدم جمع النفايات الطبية في الوقت المحدد أو اتباع إجراءات النقل.',
    penalty_c5: 'عدم الاستجابة لحالات الطوارئ (الفيضانات، الحرائق، الإخلاء).',
    penalty_c6: 'استخدام مواد تنظيف غير مرخصة داخل المنشأة.',
    penalty_c7: 'تقديم معلومات مضللة حول حضور القوى العاملة أو التقارير.',
    penalty_c8: 'توظيف عمال بدون موافقة.',
    penalty_c9: 'عدم دفع رواتب العمال.',
    penalty_d1: 'عدم اتباع التوجيهات الخاصة بتنظيف غرف المرضى وغرف العمليات ومناطق الرعاية الصحية.',
    penalty_d2: 'عدم ارتداء معدات الوقاية الشخصية المناسبة في المناطق المطلوبة.',
    penalty_d3: 'عدم إبلاغ ممثل المشروع قبل خروج الموظف أو استبداله.',
    penalty_d4: 'عدم شغل أي وظيفة محددة في العقد - في الأسبوع لكل منصب.',
    penalty_d5: 'عدم شغل الوظائف الشاغرة - في الأسبوع لكل عامل.',
    penalty_d6: 'الإهمال الذي يسبب إصابات أو أضرار في الممتلكات - يتحمل المقاول التكاليف.',
    penalty_d7: 'عدم اتباع سياسات مكافحة العدوى وإجراءات السلامة.',
    penalty_d8: 'الاستخدام غير السليم للمواد الكيميائية مما يعرض الموظفين/المرضى/الزوار للضرر.',
    penalty_d9: 'صرف مستلزمات أو أدوات التنظيف لأغراض غير متعلقة بالعمل.',
  }
};

export const I18nProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<'en' | 'ar'>('en');

  useEffect(() => {
    const root = window.document.documentElement;
    const dir = language === 'ar' ? 'rtl' : 'ltr';
    root.dir = dir;
    root.lang = language;
  }, [language]);

  const t = useCallback((key: string): string => {
    let value: any = translations[language];
    if (value && value[key]) {
      return value[key];
    }
    value = translations['en'];
    if (value && value[key]) {
      return value[key];
    }
    // Fallback: return key itself if translation missing
    return key;
  }, [language]);

  const formatDate = useCallback((date: string | Date | number, options?: Intl.DateTimeFormatOptions) => {
    const d = new Date(date);
    return d.toLocaleDateString(language === 'ar' ? 'ar-EG' : 'en-US', options);
  }, [language]);

  const formatNumber = useCallback((value: number, options?: Intl.NumberFormatOptions) => {
    return new Intl.NumberFormat(language === 'ar' ? 'ar-EG' : 'en-US', options).format(value);
  }, [language]);

  const formatCurrency = useCallback((value: number) => {
    return new Intl.NumberFormat(language === 'ar' ? 'ar-EG' : 'en-US', {
      style: 'currency',
      currency: 'SAR',
    }).format(value);
  }, [language]);

  return (
    <I18nContext.Provider value={{ 
      language, 
      dir: language === 'ar' ? 'rtl' : 'ltr', 
      setLanguage, 
      t, 
      formatDate, 
      formatNumber, 
      formatCurrency 
    }}>
      {children}
    </I18nContext.Provider>
  );
};